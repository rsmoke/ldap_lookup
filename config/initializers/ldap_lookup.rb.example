# LDAP Lookup Configuration
# Copy this file to config/initializers/ldap_lookup.rb and configure with your credentials
#
# IMPORTANT: Never commit credentials to version control!
# Use environment variables or a secrets management system.

LdapLookup.configuration do |config|
  # LDAP Server Configuration
  config.host = ENV.fetch('LDAP_HOST', 'ldap.umich.edu')
  config.port = ENV.fetch('LDAP_PORT', '389')
  config.base = ENV.fetch('LDAP_BASE', 'dc=umich,dc=edu')
  
  # Authentication - REQUIRED
  # Option 1: Use a service account (recommended for production)
  # Request a service account from your IT department
  config.username = ENV.fetch('LDAP_USERNAME')
  config.password = ENV.fetch('LDAP_PASSWORD')
  
  # Option 2: If your service account uses a custom bind DN format, specify it:
  # config.bind_dn = 'cn=service-account,ou=Service Accounts,dc=umich,dc=edu'
  # (If bind_dn is not set, it defaults to: uid=username,ou=People,base)
  
  # Encryption - REQUIRED (as of Jan 20, 2026)
  # Use :start_tls for port 389 or :simple_tls for LDAPS on port 636
  encryption_method = ENV.fetch('LDAP_ENCRYPTION', 'start_tls').to_sym
  config.encryption = encryption_method
  
  # Optional: Attribute Configuration
  config.dept_attribute = ENV.fetch('LDAP_DEPT_ATTRIBUTE', 'umichPostalAddressData')
  config.group_attribute = ENV.fetch('LDAP_GROUP_ATTRIBUTE', 'umichGroupEmail')
end
